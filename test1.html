<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sirdata CMP 示例</title>
    <!-- 添加 Sirdata CMP 安装标签 -->
    <script data-cfasync="false" src="https://cache.consentframework.com/js/pa/43928/c/OMJpR/stub" referrerpolicy="unsafe-url" charset="utf-8" type="text/javascript"></script>
    <script data-cfasync="false" src="https://choices.consentframework.com/js/pa/43928/c/OMJpR/cmp" referrerpolicy="unsafe-url" async></script>
    <script>
        function tcfApi(command, version, callback) {
            return new Promise((resolve, reject) => {
                window.__tcfapi(command, version, (response, success) => {
                    if (success) {
                        resolve(response);
                    } else {
                        reject(new Error('TCF API 调用失败'));
                    }
                });
            });
        }

        // 等待 CMP 加载
        tcfApi('ping', 2).then(pingReturn => {
            console.log('CMP 已加载:', pingReturn);
        }).catch(error => {
            console.error(error);
        });

        // 添加事件监听器
        tcfApi('addEventListener', 2, (tcData) => {
            console.log('TC String:', tcData.tcString);
            console.log('其他 consent 状态信号:', tcData);
        }).catch(error => {
            console.error(error);
        });
    </script>
</head>
<body>
    <h1>欢迎使用 Sirdata CMP 示例</h1>
    <!-- 用户可操作的按钮 -->
    <button id="promptConsentUI" class="btn">我的同意选择</button>
    <script>
        // 显示 CMP UI 按钮事件
        document.getElementById('promptConsentUI').onclick = function() {
            console.log('1');
            tcfApi('displayUI', 2).then(tcData => {
                console.log('用户操作后的 TC String:', tcData.tcString);
            }).catch(error => {
                console.error('显示 CMP UI 时发生错误:', error);
            });
        };
    </script>
</body>
</html>
